#MIN_CONFIG(3.2.0)

AM_INIT_AUTOMAKE(libksnmp, 0.3)

AC_CHECK_PROG([netsnmpconfig], [net-snmp-config], [yes], [no])

if test netsnmpconfig = yes; then
	AC_LANG_C

	saveLIBS=$LIBS
	saveLDFLAGS=$LDFLAGS
	
	LIBS="$LIBS $(net-snmp-config --libs)"
	LDFLAGS="$LDFLAGS $(net-snmp-config --ldflags)"

	AC_MSG_CHECKING([if net-snmp library can link])
	AC_LINK_IFELSE( [
		#include <net-snmp/net-snmp-config.h>
		#include <net-snmp/net-snmp-includes.h>
		
		int main()
		{
		init_snmp("test");
		}
	],
	[
		AC_MSG_RESULT([yes])
		NETSNMP_LIBS="$(net-snmp-config --libs)"
		NETSNMP_LDFLAGS="$(net-snmp-config --ldflags)"
	],
	[
		AC_MSG_FAILURE([no])
	])
fi

AC_SUBST(NETSNMP_LIBS)
AC_SUBST(NETSNMP_LDFLAGS)
